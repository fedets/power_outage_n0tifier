name: Test Telegram Connection

on:
  workflow_dispatch:

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - name: Debug: print environment (safe)
        env:
          BOT_TOKEN: ${{ secrets.TG_BOT_TOKEN }}
          CHAT_ID: ${{ secrets.TG_CHAT_ID }}
        run: |
          if [ -z "$BOT_TOKEN" ]; then echo "‚ùå BOT_TOKEN not found"; exit 1; fi
          if [ -z "$CHAT_ID" ]; then echo "‚ùå CHAT_ID not found"; exit 1; fi
          echo "‚úÖ Secrets are loaded (hidden values not printed)."

      - name: Send test message
        env:
          BOT_TOKEN: ${{ secrets.TG_BOT_TOKEN }}
          CHAT_ID: ${{ secrets.TG_CHAT_ID }}
        run: |
          echo "Sending test message to Telegram..."
          curl -v -X POST "https://api.telegram.org/bot${BOT_TOKEN}/sendMessage" \
            -d chat_id="${CHAT_ID}" \
            -d text="üëã Test message from GitHub Actions" || exit 1
          echo "‚úÖ Telegram request sent."
